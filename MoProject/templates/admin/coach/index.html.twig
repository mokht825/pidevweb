{% extends 'admin/baseBack.html.twig' %}

{% block title %}Coach index{% endblock %}

{% block body %}
<div class="row mt">
    <div class="col-md-12">
        <div class="content-panel">
            <a class="btn btn-success btn-xs" href="{{ path('coach_new') }}"><i class="fa fa-pencil"></i></a>
            <p>Ajouter un nouveaux coach</p>
        </div></div></div>
<hr>
<div class="row mt">
    <div class="col-md-12">
        <div class="form-group">
            <input type="text" class="search-input" placeholder="Type to search" id="search">
        </div></div></div>
<hr>
<div class="row mt">
    <div class="col-md-12">
        <div class="content-panel">
    <table class="table table-striped table-advance table-hover" id="table_id">
        <h4><i class="fa fa-angle-right"></i> Coach</h4>
        <hr>
        <thead>
            <tr>
                <th><i class="fa fa-flag-o"></i>Id</th>
                <th><i class="fa fa-bookmark"></i>Nomcoach</th>
                <th><i class="fa fa-bookmark"></i>Prenomcoach</th>
                <th>Genre</th>
                <th><i class="fa fa-check"></i>Disponinbilite</th>
                <th>Diplome</th>
                <th><i class=" fa fa-map-marker"></i>Localisation</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody  id="allTTT">
        {% for coach in coaches %}
            <tr>
                <td>{{ coach.id }}</td>
                <td>{{ coach.Nomcoach }}</td>
                <td>{{ coach.Prenomcoach }}</td>
                <td>{{ coach.Genre }}</td>
                <td>{{ coach.Disponibilite }}</td>
                <td>{{ coach.typesesport.nom }}</td>
                <td>{{ coach.Localisation }}</td>
                <td>
                    <a class="btn btn-success btn-xs" href="{{ path('coach_show', {'id': coach.id}) }}"><i class="fa fa-check"></i></a>
                    <a class="btn btn-primary btn-xs" href="{{ path('coach_edit', {'id': coach.id}) }}"><i class="fa fa-pencil"></i></a>
                    {{ include('admin/coach/_delete_form.html.twig') }}

                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="8">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
        <tbody id="search11"></tbody>
    </table>

    <a href="{{ path('coach_new') }}">Create new</a>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            <script>
                $( document ).ready(function() {
                    $("#search").keyup(function(e){
                        /* La variable value va prendre la valeur insérer dans le champ de texte
                        afin d’effectuer la recherche */
                        var value = $(this).val();
                        /* Ajax est lancé lors du remplissage du champ texte dont l’id est
                        « search » pour faire la recherche */
                        $.ajax({
                            /* l’url est une chaine de caractères contenant l’adresse où la requête est
                            envoyée */
                            url : "{{ path('search') }}",
                            /* La méthode utilisée pour transférer les données est GET */
                            type : 'GET',
                            /*Ici search value va prendre la chaine entrée par un utilisateur dans la
                            zone de recherche et sera placée après l’url */
                            data: {
                                'searchValue' : value
                            },
                            /*Cette fonction permet de vider le contenu du tableau pour recevoir le
                            nouveau contenu*/
                            success : function(retour){
                                if(retour){
                                    $("#search11").empty();

                                    $.each(JSON.parse(retour), function(i, obj) {
                                        $("#allTTT").hide();
                                        $("#search11").append(
                                            '<tr>' +
                                            '<td> '+obj.id+' </td>' +
                                            '<td> '+obj.Nomcoach+' </td>' +
                                            '<td> '+obj.Prenomcoach+' </td>' +
                                            '<td> '+obj.Genre+' </td><td> '+obj.Disponinbilite+' </td>' +
                                            '<td> '+  +' </td>' +
                                            '<td>'+obj.Localisation+'</td>' +

                                            '<td><a class="btn btn-success btn-xs" href="coach_show'+obj.id+'"><i class="fa fa-check"></i></a></td>' +

                                            '<td><a class="btn btn-primary btn-xs" href="coach_edit'+obj.id+'"><i class="fa fa-pencil"></i></a></td></tr>');
                                    });
                                }
                                else
                                {
                                    $('#allTTT').show();
                                    $('#search11').empty();
                                    $('#search11').fadeIn('fast');
                                }

                            },
                        });
                        return false;
                    });
                });
            </script>
        </div>
    </div>
</div>
    <br>

    <div class="row mt" style="width: 600px; height: 600px; margin-left: 200px;">

        <div class="col-md-12">

            <div class="content-panel">
                <h4><i class="fa fa-angle-right"></i> Staitistique selon les Diplomes</h4>
                <hr>
                <canvas id="mescoach" width="700" height="300"></canvas>

            </div></div></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.1.0/chart.min.js" integrity="sha512-RGbSeD/jDcZBWNsI1VCvdjcDULuSfWTtIva2ek5FtteXeSjLfXac4kqkDRHVGf1TwsXCAqPTF7/EYITD0/CTqw==" crossorigin="anonymous"></script>
    <script>
        let mescoach = document.querySelector("#mescoach")
        let mescoachGraph = new Chart(mescoach, {
            type: 'pie',
            data: {
                labels: {{ typeSportNom| raw }},
                datasets: [{
                    label: '# types',
                    data: {{ typeSportCount| raw }},
                    backgroundColor: {{ typeSportColor| raw }},
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
    <a href="{{ path('coach_indexC') }}">interface client</a>
{% endblock %}
